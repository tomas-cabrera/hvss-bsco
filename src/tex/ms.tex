% Define document class
\documentclass[twocolumn]{aastex631}
\usepackage{showyourwork}

% My commands
\newcommand{\kms}{${\rm km~s^{-1}}$}
\newcommand{\Msun}{$M_\sun$}
\newcommand{\CMC}{\texttt{CMC}}
\newcommand{\CMCcat}{\texttt{CMC Cluster Catalog}}
\newcommand{\fewbody}{\texttt{Fewbody}}

\shorttitle{Runaway \& hypervelocity stars from globular clusters}
\shortauthors{Cabrera et al.}

% Begin!
\begin{document}

% Title
\title{Runaway and hypervelocity stars from binary-single encounters in globular clusters}

% Author list
\author[0000-0002-1270-7666]{Tom\'as Cabrera}
\affiliation{McWilliams Center for Cosmology,
    Department of Physics,
    Carnegie Mellon University,
    5000 Forbes Avenue, Pittsburgh, PA 15213
}

\author[0000-0003-4175-8881]{Carl L. Rodriguez}
\affiliation{McWilliams Center for Cosmology,
    Department of Physics,
    Carnegie Mellon University,
    5000 Forbes Avenue, Pittsburgh, PA 15213
}

% Abstract with filler text
\begin{abstract}
    An abstract.
\end{abstract}

% Main body with filler text
\section{Introduction}
\label{sec:intro}

Hypervelocity stars (HVSs) are stars that have been accelerated beyond the local galactic escape speed, that is, to the point of becoming unbound from the galactic potential.
Theorized by \citealt{1988Natur.331..687H}, the classical origin of HVSs is the dynamical disruption of a stellar binary by a super massive black hole (SMBH); this ``Hills mechanism" is believed to be capable of accelerating stars to speeds up to 4000 km s$^{-1}$, and naturally makes HVSs potential probes of the galactic center.
Since the first HVS discovery \citep{2005ApJ...622L..33B}, a handful of candidate objects have been identified in the Milky Way (MW) (e.g. \citealt{2014ApJ...787...89B}), including the object S5-HVS1, with a measured speed of $\sim$1700 km s$^{-1}$ \citep{2020MNRAS.491.2465K}.
While S5-HVS1, along with several others, is well-explained by accepting an origin from the galactic center, for which there is overwhelming evidence for an SMBH (\citealt{1998ApJ...509..678G}, \citealt{2018A&A...615L..15G}, \citealt{2022ApJ...930L..12E}), recent studies have found examples of high-velocity stars that are not so easily read \citep[e.g.][]{2018MNRAS.479.2789B, 2019MNRAS.483.2007E, 2021A&A...646L...4I}.
Two consistent results from these lines of work are that many stars previously classified as HV are nonetheless bound to the galactic potential, and many of these ``runaways" are more likely to have been ejected from the disk or a satellite as opposed to the galactic center.
Altogether, the identification of systems of origin for HV and runaway stars is a necessary threshold problem to unlocking the full potential of observations of these objects.

Alternate acceleration mechanisms capable of producing high-velocity stars include the binary supernova and dynamical ejection scenarios (BSS \citep{1967BOTT....4...86P} and DES \citep{1961BAN....15..265B}, respectively).
The BSS has been predicted to accelerate stars to speeds of a few hundred \kms \citep{2019A&A...624A..66R}, with exceptionally light companions potentially receiving velocities in excess of 1000 \kms \citep{2015MNRAS.448L...6T}.
The DES has been associated with higher speed limits: \citet{1991AJ....101..562L} studied these encounters with numerical methods, and found that the upper limit for products of these encounters was approximately the escape speed from the surface of the most massive star involved; for a sun-like star, this escape speed is $\sim$620 \kms, while for a 60 $M_\odot$ late main-sequence star it is $\sim$1400 \kms.

Globular clusters (GCs) are obvious candidate matrices for both of these events due to their high stellar densities, but the DES might be exceptionally amplified due to the combined effects of mass segregation and stellar evolution.
This process is characterized as the migration of the most massive objects to the center of a self-gravitating system due to dynamical friction \citep{2008gady.book.....B}, which in turn leads to efficient formation of binaries in the core \citep{2005MNRAS.358..572I}.
This central population of binaries is highly influential on the evolution of the cluster, primarily serving as a heat source as binaries form and shrink through dynamical encounters, undergoing one kind of ``core collapse" in the process \citep[e.g.][]{2007ApJ...658.1047F, 2013MNRAS.429.2881C}.
In a realistic cluster, these dynamical phases occur after stars have started collapsing into black holes (BHs), and such objects dominate the core population \citep{2020IAUS..351..357K}.
The resulting abundance of black hole binaries (BBHs) characterizes GCs as one of the favorable progenitors of gravitional wave sources \citep{2000ApJ...528L..17P, 2015PhRvL.115e1101R}, and in the context of this paper motivates the investigation of whether the population of GCs in the Milky Way (MW) can be considered a significant source of high-velocity stars.

This work investigates the capacity of GCs to produce HVSs through the DES, particularly in encounters between binaries and single objects, which may include compact objects (COs, a category that includes BHs, white dwarfs (WDs), and neutron stars (NSs)).
We compose a realistic set of these binary-single compact object (BSCO) encounters by pulling initial conditions from the \CMCcat\ of MW-like GC models \citep{2020ApJS..247...48K}.
\CMC\ is a H\'enon-style Monte Carlo code for $N$-body simulations of star clusters, and has the relevant features of stellar evolution implementation and direct integration of strong encounters between stars and stellar multiples; the referenced catalog consists of 148 models which span much of the parameter space of MW GCs.
This analysis concludes that GCs are possible generators of HVSs in all velocity regimes thus observed, beyond the previously established limit for star-only encounters, albeit the rate at which these objects are produced from GCs is significantly lower than that for the galactic center.

\section{Methods} \label{sec:methods}

\subsection{Binary-single encounter population} \label{subsec:binsingle_pop}

\CMC\ records all strong encounters that required direct integration during a cluster model run.
To establish realistic binary-single encounter populations for clusters of various parameters, we take the 148 models from the \CMCcat\ and extract the initial conditions of all strong binary-single encounters that involve at least one luminous object (star, WD, or NS) and one compact object.
These criteria on the constituents are applied in order to ensure that each encounter has a change of producing an observable object, and to focus on the effects COs have on this population.
Over the entire catalog, our encounter sample makes up about half of all strong encounters that occur in the models, with each model contributing a few ten thousand BSCO encounters on average.
We then realize each encounter in isolation with the small-$N$-body code \fewbody\ \citep{2004MNRAS.352....1F}.
We compute 10 realizations of each encounter, varying the encounter angles for each realization, to obtain a better statistical representation of the binary-single encounter population.

The resulting objects that leave the cluster to become runaway or HVSs are identified as follows.
\fewbody\ terminates integration before the resulting objects are far from each other's gravitational influence; therefore, the final velocity of an object after an encounter $v_{\rm fin}$ is calculated as the hyperbolic excess velocity
\begin{equation}
    v_{\rm fin} = v \sqrt{\frac{U + K}{K}},
\end{equation}
where $v$ is the velocity of the object, and $U$ and $K$ are the Keplerian potential and kinetic energies of the top-level binary-single system (all of these quantities are evaluated at the termination of integration).
The local escape velocity of the star cluster $v_{\rm esc}$ is provided by \CMC\ with the other encounter parameters; any object with $v_{\rm fin} \ge v_{\rm esc}$ is considered to escape the cluster, suspending the possibility of subsequent encounters.
The velocity of an ejected object once it has left the cluster is therefore
\begin{equation}
    v_{\rm out} = \sqrt{v_{\rm fin}^2 - v_{\rm esc}^2}.
\end{equation}

It is worth noting that the encounter initial conditions recorded in the \CMCcat\ contain velocities calculated in the center-of-mass frame of the encounter.
A more rigorous calculation of $v_{\rm out}$ would utilizes the velocity dispersion $\sigma$ to determine how $v_{\rm fin}$ translates to a velocity in the reference frame of the star cluster model.
Assuming that the distribution of the 3D object velocity $\vec{v}_{\rm fin}$ is independent of the center-of-mass velocity $\vec{v}_{\rm cm}$ of the encounter it originated from, we find that the average ratio of speed after to speed before the transformation to the cluster reference frame $v'_{\rm fin} / v_{\rm fin}$ is a maximum of $\sim$1.3 in the case $v_{\rm fin} \approx \sigma$, and a minimum of 1 in the case $v_{\rm fin} \gg \sigma$.
As $v_{\rm cm} \sim \sigma$ and $\sigma \lesssim v_{\rm esc}$ [CITATIONS?], we estimate that neglecting a transformation to the cluster reference frame after center-of-mass encounter integration shrinks the resulting ejection populationoverall, but not in a manner that significantly affects the following analysis.

\subsection{Core collapse and ejecta} \label{subsec:cc}

The core collapses of star clusters due to dynamical heat flow from the center to the outer regions of a system are well-documented processes (e.g. \citealt{1968MNRAS.138..495L}, \citealt{2020IAUS..351..357K}).
One kind of core collapse occurs when the population of BHs in cluster (localized to the center via. mass segregation) is depleted through fewbody encounters in this region; the dynamically less energetic core is no longer able to fuel the dynamics of the rest of the cluster, and the cluster contracts.
Many of these core encounters are between a binary and a single, contain compact objects, and can impart large accelerations on the participants, and accordingly are of particular interest here.

In this analysis, we label a cluster as core collapsed when its population of BHs has been reduced to less than 10 members \citep{2020IAUS..351..357K}.
By this metric, 69 of the 148 \CMCcat\ models achieve core collapse by the end of the 14 Gyr integration time, and small cluster mass and size are good predictors of systems that evolve to this point the fastest.

\subsection{Estimating a MW-like population} \label{subsec:est_MW-like}

In the interest of predicting realistic statistics and rates for a MW-like GC population, we seek to assemble a synthetic MW-like population of GC-runaways from BSCO encounters.
The two steps involved here are 1) selecting representative \CMC\ models for galactic GCs, and 2) integrating the post-ejection orbits to the present day in the context of the MW.

\subsubsection{Pairing \CMC\ models to MW GCs} \label{subsubsec:pairing}
% Plot idea: the log(M) vs. rr vs. r_hm diagnostic plots in gcs_mw-cmc.ipynb, with top/bottom//left/right axes showing the physical and normalized values of each variable

The 148 \CMC\ models are designated by cluster initial size $N$ (number of stellar objects), initial virial radius $r_{\rm vir}$ (parsecs), distance from the galactic center $r_{\rm gc}$ (kiloparsecs, used in \CMC\ to calculate tidal effects from the galactic potential), and metallicity $Z$ (used to prescribe star evolution), with values chosen to span much of the MW GC parameter space; see \citet{2020IAUS..351..357K} for more details.

We predominantly use the observational catalog of \citet{2018MNRAS.478.1520B} to obtain parameters for MW GCs.
This catalog lacks metallicity measurements for the objects; therefore we supplement with that of \citet{2010arXiv1012.3224H}.
12 of the GCs in the former catalog do not have metallicity measurements in the latter, leaving us with the 149 Mw GCs we use in this analysis.

We choose a representative \CMC\ model for each MW GC in the following manner.
For each GC, after \citet{2021ApJ...912..102R} we first find the values of $r_{\rm gc}$ and $Z$ in the \CMCcat\ model grid closest to the measurements of these parameters for the GC (in linear and log space, respectively) and select the models with the respective values as candidate representatives.
We choose 11 linearly spaced times between 10 and 13.5 Gyr (c.f. \citet{2013ApJ...775..134V}), and find the \CMC\ timesteps closest to the chosen times for the candidate models.
The MW GCs and the \CMC\ models are shown in Figure \ref{fig:cmcs-mwgcs_scatter}.

The representative model is chosen by finding the model timestep closest to the GC in normalized $\log M$-$r_c / r_h$ space by Euclidean distance.
We choose these parameters as in this context of GC population synthesis they are reasonable proxies for respectively the scale and evolutionary state of the cluster.
We use the 3D half-mass radius for $r_h$, and the definition of core radius from \citet{1987degc.book.....S}:
\begin{equation}
    r_c = \sqrt{\frac{3 \sigma_c^2}{4 \pi \rho_c}},
\end{equation}
where $\sigma_c$ is the central velocity dispersion and $\rho_c$ is the central density for the cluster.
We normalize the two dimensions in the \CMC\ space, i.e. the parameters actually used to compute the distance are
\begin{equation}
    x_{\rm norm} = \frac{x - \bar{x}_{\rm \CMC}}{\sigma_{\rm x, \CMC}},
\end{equation}
where $\bar{x}_{\rm CMC}$ and $\sigma_{\rm x,CMC}$ are respectively the mean and standard deviation of the parameter $x$ over the total set of \CMC\ models.

\begin{figure}
    \script{cmcs-mwgcs_scatter.py}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/cmcs-mwgcs_scatter.pdf}
        \caption{
        The clusters and models used in this work.
        Galactic GCs are represented by black triangles, and CMC models by blue dots.
        %The sample \CMC\ models used in \S\ref{subsec:single_clusters} are shown as blue stars.
        %M3 and its \CMC\ counterpart relevant to \S\ref{} are shown as purple triangles.
        Cluster mass $M_{\rm cluster}$ is shown on the $y$-axis, and the core radius/half-mass radius ratio $r_c/r_h$ (metallicity $[{\rm Fe/H}]$) on the left (right) $x$-axis.
        }
        \label{fig:cmcs-mwgcs_scatter}
    \end{centering}
\end{figure}

While the \CMCcat\ has fairly representative models for most of the MW GCs, there are a number of larger-cored GCs (right side of the left pane of Figure \ref{fig:cmcs-mwgcs_scatter}) that are relatively distant from the nearest \CMC\ model; in practice, this means that a single \CMC\ model can be chosen to represent a disproportionate number of MW GCs.
Our pairing algorithm ends up using 57 of the 148 \CMC\ models to build the sythetic population, and the most utilized model is matched to 14 MWGCs, or $\lesssim10\%$ of the population.
The most used models are typical in terms of number of ejections and cluster evolution, and so while the more extreme GCs might be misrepresented, they are being represented by average models nonetheless.

\subsubsection{Integrating runaways to the present day} \label{subsubsec:galpy}

We now produce a present-day picture of these runaways by evolving their trajectories to the present day, using \texttt{galpy}\footnote{http://github.com/jobovy/galpy} \citep{2015ApJS..216...29B} to perform the necessary integrations.
For each MW GC, we consider the matched \CMC\ model timestep as the present-day representation of the system, and pair it with the present-day orbital position and velocity from \citet{2018MNRAS.478.1520B}.
We integrate the orbit backwards through time, and place the ejected objects at the appropriate times in the trajectory.
The ejection velocity $v_{\rm out}$ from the model is assigned a random direction and boosted to the galactic rest frame, and this trajectory is evolved to the present day.

\section{Results} \label{sec:results}

\subsection{Ejections from single clusters} \label{subsec:single_clusters}

Here we study the BSCO ejections produced by individual \CMC\ cluster models.
\CMC\ model N8e5\_rv0.5\_rg8\_Z0.0002 is taken as a sample as it represents a typical MW GC, and models N4e5\_rv0.5\_rg8\_Z0.0002, N8e5\_rv0.5\_rg8\_Z0.0002, and N8e5\_rv2\_rg8\_Z0.02 are included to examine the effects parameter variation has on the population of ejected objects.
For simpler reference, we name the first sample model the ``base" model, and the remaining three the ``low-mass", ``bigger", and ``high-metallicity" models, respectively.

It is relevant to note a strong correlation between BSCO encounters and the evolution of the cluster core.
Figure \ref{fig:cmc_single_clusters_vesc} plots the local escape velocities $v_{\rm esc}$\footnote{$v_{\rm esc}$ here is to be considered as a proxy for the distance from the center of the cluster.} for all BSCO encounters from the sample models, along with the central density $\rho_c$ \citep{1985ApJ...298...80C}, scaled to the initial density of the model $\rho_{c,0}$.
Within any small interval of time, the respective BSCO encounters are well-localized around a particular escape velocity, indicating that throughout the evolution of the cluster contemporary encounters are similarly localized to the same cluster radii.
Furthermore, the variation of this ``particular escape velocity" mimics the variation of the core density of the cluster.
Naturally one would expect the densest part of a system to facilitate the highest rates of few-body encounters; in this case the dominance is extreme enough to characterize the encounter statistics as a whole.

\begin{figure}
    \script{cmc_single_clusters_vesc.py}
    \centering
    \includegraphics[width=0.49\textwidth]{figures/cmc_single_clusters_vesc.pdf}
    \caption{
        The local escape velocities $v_{\rm esc}$ of all BSCO encounters generated from the four sample \CMC\ models (colored points), plotted alongside the central density $\rho_c$ of the model (maroon), that latter of which is divided by the initial central density of the model.
        See Figure \ref{fig:cmc_single_clusters} for an explanation of the color scheme.
    }
    \label{fig:cmc_single_clusters_vesc}
\end{figure}

Figure \ref{fig:cmc_single_clusters} shows the ejection velocity $v_{\rm out}$ for every MS star ejected via. a BSCO encounter in these clusters, plotted at the time of encounter since the cluster's formation $t$.
By comparing the scatter plot to the evolution of the $N$-body core radius $r_{c, NB}$ \citep{1985ApJ...298...80C}, it is clear how the BSCO encounters and ejections are linked to the dynamical evolution of the cluste: whenever a cluster undergoes a core collapse, the heightened densities lead to predictably high encounter rates.

\begin{figure*}
    \script{cmc_single_clusters.py}
    \gridline{
        \fig{figures/cmc_single_clusters_vout-N8e5-rv0.5-rg8-Z0.0002_S.pdf}{0.49\textwidth}{}
        \fig{figures/cmc_single_clusters_vout-N4e5-rv0.5-rg8-Z0.0002_S.pdf}{0.49\textwidth}{}
    }
    \gridline{
        \fig{figures/cmc_single_clusters_vout-N8e5-rv2-rg8-Z0.0002_S.pdf}{0.49\textwidth}{}
        \fig{figures/cmc_single_clusters_vout-N8e5-rv0.5-rg8-Z0.02_S.pdf}{0.49\textwidth}{}
    }
    \caption{
        Scatter plots of the cluster ejection velocity $V_{rm out}$ versus encounter time $t$ for every escaping object from the integrated encounters for the four sample \CMC\ models (see the beginning of \S\ref{subsec:single_clusters} for details).
        The histograms show the same data in 1D.
        The different types of encounters are color-coded: encounters between a binary star and a CO are in red,
        encounters between a mixed binary (1 star and 1 CO) and a CO are in blue, encounters between a mixed binary and a star are in yellow, and encounters between a CO binary and a star are in purple.
        The $N$-body core radius $r_{c, NB}$ \citep{1985ApJ...298...80C} of the model is plotted in maroon over the timewise histogram.
    }
    \label{fig:cmc_single_clusters}
\end{figure*}

An interplay between stellar evolution and cluster dynamics is revealed in the kinds of BSCO encounters that occur at certain times.
The most massive stars in a cluster are both the first to form binaries and the first to evolve into COs; hence, in general encounters between a mixed binary (composed of a MS star and a CO) and a single MS star dominate the first generations of BSCO encounters.
This dominance usually continues until the first core collapse after CO formation, where the heightened densities facilitate a rise in encounters involving 2 COs.
There is a stark difference in the ejection velocities produced by these encounters in comparison to the previous mixed binary-single MS star encounters, and the fastest ejections over the cluster's lifetime are produced in the first tens of Myr after the associated core collapse.
This regime lasts for a few to tens of Gyr, during which the COs in the core (predominantly BHs) preferentially form CO-CO binaries, as evidenced in the drop of mixed binary-single CO encounters during this phase.

For cluster models that evolve to a BH-ejection core collapse (in our sample, all but the large model), the corresponding increase in BSCO encounters is dominated by stellar binary-single CO encounters.
The coupling between core evolution and BSCO encounter localization appears to weaken in this phase, as the rapid increase(decrease) in core density(radius) does not translate to a similarly strong increase in escape velocity, though an increase still occurs (cf. Fig. \ref{fig:cmc_single_clusters_vesc}).
We also find that the majority of these encounters do not involve BHs, but rather WDs (or in some cases a NSs).
These behaviors are consistent with the picture of the remaining COs migrating inwards to the core after the ejection of nearly all BHs.

This general evolution varies with model parameters, as can be observed by comparing different panels of Fig. \ref{fig:cmc_single_clusters}.
The low-mass model lacks a core energetic enough to sustain a larger spatial profile, and the resulting strong contraction of the core leads to an ejection of 5\% of the cluster mass via BSCO encounters in the first 100 Myr.
This model does reach a BH-ejection core collapse by the end of the integration time, but this collapse is slower than that for the base model.

The bigger model evolves slower, and so it does not reach the same core collapse phase as the previous two.
The lower densities prevent the initial dominance of mixed binary-single star encounters, as the frequency of BSCO encounters is relatively low until the initial core collapse.
On the other hand, this first core collapse is not associated with an abundance of BSCO encounters in the high-metallicity model, which sees a roughly monotonic rise in BSCO encounters throughout its evolution.
% Talk to Carl about interpretation of high metallicity model

Figure \ref{fig:cmc_catalog} shows histograms for cluster ejection velocities $v_{\rm out}$ and masses $m$ of all stars ejected by BSCO encounters in all \CMCcat\ models, binned by model parameters $N$, $r_{\rm vir}$, and $Z$.
The number of \CMC\ models corresponding to each parameter value varies, and so each histogram is averaged over the respective models, in addition to being divided by the factor of 10 in encounter multiplication.
The travel distances $d$ are the distances an object would move in a straight line between ejection and the present day, that is, the product of the ejection velocity and the time interval between the time of ejection and 14 Gyr.
It is worth noting the prominence of the $N = 4\times10^5$, $r_{\rm vir} = 0.5$ pc, $Z = 0.0002$ models in these averaged histograms: they are the cause of the peaks above the other distributions, as the three (one for each value of $r_{\rm gc} \in \{2, 8, 20\}$ kpc) produce significantly more ejections than the other models ($\sim$2.9, 2.0, and $1.4 \times 10^4$, respectively, versus the average number of $1-2 \times 10^3$ for the catalog).

% Play with this figure placement after text is done:
%   figure* will let it span over both columns
%   placing the \fig commands in the same gridline will place them in the same horizontal row

\begin{figure*}
    \script{cmc_catalog.py}
    \centering
    \includegraphics[width=\textwidth]{figures/cmc_catalog_S.pdf}
    \caption{
        Histograms for all MS stars ejected from the \CMCcat\ models as a result of BSCO encounters.
        The three columns display the cluster ejection velocities $v_{\rm out}$, the present-day straight-line travel distances $d$, and the masses $m$ of the ejected objects, respectively.
        Each row divides the data across the values for the \CMC\ model parameters size $N$ (number of objects), initial virial radius $r_{\rm vir}$ (parsecs), or metallicity $Z$.
        Each histogram is averaged over all models computed with the respective model parameter.
        In the right column (the mass plots), the data are further divided by whether the ejection occurred before or after the BH-ejection core collapse of the cluster, if one occurred within the integration time.
    }
    \label{fig:cmc_catalog}
\end{figure*}

Acknowledging these especially fecund models, predicable trends are visible in these histograms: increasing mass and decreasing size are both associated with higher ejection velocities and accordingly higher travel distances.
However, while the smallest clusters produce the most ejections, the most massive clusters produce the \textit{fewest} ejections.
The $N = 4 \times 10^5$ models consistently produce the most ejections in comparison with otherwise identical models of different population sizes, suggesting that at this mass there are not enough massive objects to prevent a severe initial core collapse through binary burning, but there are enough to facilitate a high number of BSCO encounters (the number of few-body encounters in general is also maximized in the $N = 4 \times 10^5$ models).

The most noticeable distinction among models of different metallicities is the number of ejections, which decreases with increasing metallicity.
This is understandable, as higher metallicities lead to lower-mass objects, which in turn lead to weaker few-body encounters.
This has a slight effect on the mass spectrum of ejected objects above 1 $M_\odot$, but a much stronger one for the objects below this cutoff mass.
Tthe different metallicity-binned models diverge significantly, and only in the ejections that occur before the BH-ejection core collapse of the model.
This same phenomenon is visible in Fig. \ref{fig:cmc_single_clusters}, wherein it was previously noted that the high-metallicity model did not produce many ejections during its initial core collapse.
The low-metallicity model is able to produce many ejections primarily because of the higher stellar masses, which lead to a greater population of black holes in number and average mass, enabling stronger dynamics.
%because 1) its core collapse is deeper, and 2) there are roughly $1.2 \times$ as many BHs present at core collapse, and 3) the BHs in the low-metallicity model are up to $2 \times$ as massive as those in the high-metallicity model.

\subsection{Galactic population} \label{subsec:res_MW-like}

We now consider the MW-like population of BSCO runaways, assembled from the \CMCcat\ models as described in section \S\ref{subsec:est_MW-like}.

Figure \ref{fig:encio_stackedbar} shows the encounter types and results for BSCO encounters from a MW-like population of GCs, with the top plot including all encounters and the bottom including only those that result in an ejection.
The majority of BSCO encounters are between a mixed binary and a star, and the bulk of the remaining encounters involve two COs.
Interactions between COs and stellar binaries are relatively rare, and mostly occur after a secondary core collapse in which COs (esp. BHs) are ejected from the cluster core (c.f. Fig. \ref{fig:cmc_single_clusters}).

%\begin{figure}
%    \scripts{encio_stackebar.py}
%    \centering
%    \includegraphics[width=0.49\textwidth]{encio_stackedbar_catalog_wmw_dej.pdf}
%    \caption{
%        Results of all BSCO encounters from the MW-weighted cluster population.
%        The x-axis shows the encounter type, the colors denote the result of the encounter, and the color saturation and hatch indicates whether the encounter ejected an object from the host cluster or not.
%        The black percentages show what part of the encounter type bar is filled by the respective result.
%    }
%    \label{fig:encio_stackedbar}
%\end{figure}

Of all BSCO encounters in our synthetic MW population, $\sim3\%$ eject at least one of the interacting bodies out of the host cluster.
Most star-ejecting encounters are between a single star and a binary.
In comparison, when a CO interacts with a binary containing at least one star, generally the star remains in the binary, and when the star is ejected from the binary it is more likely for all three objects to depart as singles with smaller velocities than for a single star to carry away enough of the encounter's energy to overcome the local escape velocity (c.f. \citet{1983ApJ...268..319H}).
We conclude that the most characteristic star-ejecting BSCO encounters in the galaxy (in terms of maximum velocities and abundance) occur shortly after the formations of COs and multiple-CO systems, the latter of which we have demonstrated is strongly linked to the core collapse timescale of galactic GCs.

Figure \ref{fig:gc_orbit_ejections} shows the integrated orbits for a selection of GCs, and the points at which objects are ejected from the cluster.
As was seen earlier, ejections occur much more frequently in the early stages of the cluster, and here the slower velocities at larger distances from the galactic center leads to a higher percentage of objects being ejected far away from this focus.

\begin{figure*}
    \script{gc_orbit_ejections.py}
    \gridline{
        \fig{figures/gc_orbit_ejections_NGC_104.pdf}{0.49\textwidth}{}
        \fig{figures/gc_orbit_ejections_NGC_5139.pdf}{0.49\textwidth}{}
    }
    \gridline{
        \fig{figures/gc_orbit_ejections_NGC_6205.pdf}{0.49\textwidth}{}
        \fig{figures/gc_orbit_ejections_NGC_7089.pdf}{0.49\textwidth}{}
    }
    \caption{
        Plots showing the back-integrated orbits for some MW GCs, and the points in the orbit where an object is ejected from the GC.
        The color scale of the points indicates the time of ejection, measured backward from the present day; from the partial monochromism of the data and the density of points for portions of the orbit it can be seen how the ejections are more concentrated earlier in the cluster's evolution and farther away from the galactic center.
    }
    \label{fig:gc_orbit_ejections}
\end{figure*}

The present-day sythetic populations of runaways for the same sample CMC/GC pairings are shown in Figure \ref{fig:gcej_today}.
While it is clear how the GC orbits influence the distribution of ejected objects, the ejecta wander to a broad enough spread that any one object loses some of the information of its cluster of origin by the present day.
The proper motion distribution is less affected in this way (especially for more circular GC orbits), which is coherent with previous works that use these velocities to study the origins of such objects.
What is important to note here is that the current proper motion of the cluster is not necessarily the best locus to use when comparing stellar proper motions: a well-informed back-integration of the orbit can reveal the average proper motion of the cluster, which may be distiguishable from its present-day proper motion.

\begin{figure*}
    \script{gcej_today.py}
    \gridline{
        \fig{figures/gcej_today_NGC_104.pdf}{0.49\textwidth}{}
        \fig{figures/gcej_today_NGC_5139.pdf}{0.49\textwidth}{}
    }
    \gridline{
        \fig{figures/gcej_today_NGC_6205.pdf}{0.49\textwidth}{}
        \fig{figures/gcej_today_NGC_7089.pdf}{0.49\textwidth}{}
    }
    \caption{
        Present-day positions (galactic longitude/latitude) and velocities (projected onto the galactic longitude/latitude directions) for the runaway objects from the sample GCs.
        The color scale again denotes the time of ejection.
        The back-integrated orbits are shown as the light gray trajectories, and the blue "x" is the position/velocity of the GC as measured by \citet{2018MNRAS.478.1520B}.
        The set of sythetic ejecta shown here is the result of downsampling the total set by a factor of ten, to account for the repeated-realizations method described in \S\ref{subsec:binsingle_pop}
    }
    \label{fig:gcej_today}
\end{figure*}

From a galactocentric perspective, the population of runaways is fairly isotropic in position, as can be seen in Figure \ref{fig:rgc-z}.
The distributions of distance from the galactic origin, and the local distributions of galactocentric velocity are similar when distributing over radius $r_{\rm gc}$ versus distance from the galactic plane $Z_{\rm gc}$.
Most runaways end up at a distance on the order of 10 pc from the galactic center, and with a velocity on the order of 100-300~\kms.
Few runaways make it past the $\sim$100 pc mark, but those that do naturally retain the highest velocities, reaching upwards of 1000~\kms.
% So this indicates that hypervelocity stars are likely to come from other sources, since the fastest BSCO runaways will have had plenty of time to leave the galaxy?

% Combine these plots into 2x2 grid (hists. on top, either column: r or Z)
% Make the same plots for all ejecta w/ v_rf > 275?
% Change the plots to be based on v_rf instead of v_esc?
\begin{figure*}
    \script{rgc-z.py}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/rgc-z_S.pdf}
        \caption{
            Histograms and velocity quantiles for the synthetic ejecta.
            The left (right) plots show the profile over radial distance from the galactic center $r_{\rm gc}$ (distance from the galactic plane $Z$).
            The quantiles in the lower plots are calculated from the present-day velocities of our population.
        }
        \label{fig:rgc-z}
    \end{centering}
\end{figure*}

One final result of note is that of the heliocentric radial velocity $v_{\rm rf}$ distribution of the synthetic population.
\citet{2021arXiv211213864G} in part studied the galactic center origin of HVSs, and found that there is an apparent tension between the observed and predicted runaway populations; specifically, the predicted number of stars with velocities $\gtrsim 700~{\rm km~s^{-1}}$ was much higher than the observed rate from the HVS sample of \citet{2018ApJ...866...39B}.
The same work found that a decreasing star formation rate over last millions of years would reduce the recent (and thus more likely to be observed) HVS production rate enough to overcome the discrepency.
GCs natural follow this pattern (c.f. S\ref{subsec:single_clusters}), as the BSCO runaways studied here are produced at much higher rates when the models are young, and few HVSs are produced in the later stages of the cluster.
The resulting $v_{\rm rf}$ distribution is much closer to the observed distribution than that for the galactic center origin case, albeit skewed towards slightly smaller velocities (Figure \ref{fig:cmc_orbits_cdf}).
This latter difference grows when comparing to the HVS sample of \citet{2018ApJ...866..121H}, who focused on metal-poor stars, which are more akin to the objects that populate GCs.

\begin{figure}
    \script{cmc_orbits_cdf.py}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/cmc_orbits_cdf_S.pdf}
        \caption{
            Velocity distributions for our sythetic and some previous observational HVS catalogs.
            $v_{\rm rf}$ is the heliocentric radial velocity of the star as measured in the galactic rest frame.
        }
        \label{fig:cmc_orbits_cdf}
    \end{centering}
\end{figure}

Figure \ref{fig:mwej_rates} shows the rate of HVS/runaway production for our sythetic population, along with some base values from the literature.
In both cases, the GC ejection rate is smaller than the observed rate, especially at the present day.
However, runaways from GCs could make up an appreciable fraction of runaways in the early universe.
It is also of note that GCs are able to produce any HVSs at all, at velocities previously associated entirely with the galactic center.

\begin{figure}
    \script{mwej_rates.py}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/mwej_rates.pdf}
        \caption{
            The ejection rate for the synthetic MW GC population.
            The red dashed line represents the HVS rate for the galactic center, and the blue dashed line the runaway rate for the disk proposed by \citep{2015ARA&A..53...15B}.
        }
        \label{fig:mwej_rates}
    \end{centering}
\end{figure}

% \begin{equation}
%     R_{GC,ej}
%     \sim \frac{\sum_i N_{MW,i} \frac{N_{ej,i}}{10}}{13.8~{\rm Gyr}}
%     \approx 0.02~{\rm Gyr}^{-1},
% \end{equation}
% where $i$ indexes over the \CMC\ models, $N_{MW,i}$ is the number of MW GCs that have the $i^{th}$ model as their nearest \CMC\ neighbor, and $N_{ej,i}$ is the number of single objects from the integrated encounters with a hyperbolic excess velocity greater than the local GC escape speed for the $i^{th}$ model (the division by 10 accounts for the multiplication of encounters described in section \ref{sec:methods}).

% \subsubsection{Ejection velocities}
%
% Of the 148 clusters, 51 clusters have a maximum ejection velocity $v_{\rm out,max}>1000~{\rm km~s}^{-1}$, 23 clusters with $v_{\rm out,max}>1500~{\rm km~s}^{-1}$, and 3 clusters with $v_{\rm out,max}>2000~{\rm km~s}^{-1}$.
% The fastest ejection velocity is found in the realizations of the $N=8\times10^5,\ r_{\rm vir}=0.5~{\rm pc},\ r_{\rm gc}=20~{\rm kpc}, Z=0.01~Z_\odot$ cluster, where a single $31~M_\odot$ mass BH replaces a $0.15~M_\odot$ mass star in a binary with a $69~M_\odot$ mass BH to accelerate the star to a speed of $\sim$2160~\kms.
% This is noticeably greater than the surface escape velocity of a 69~$M_\odot$ star ($\sim$1500~\kms, assuming a radius of $R_*\approx12~R_\odot$), the theoretical limit given by the method of \citet{1991AJ....101..562L}.

\section{Discussion \& Conclusions} \label{sec:disccon}

In this work we have studied fewbody encounters in GCs as means of producing stellar runaways.
We composed a synthetic MW-like population of ejecta by matching observed GCs to realistic $N$-body models of these systems and embedding the models in the orbits of their real counterparts.
In particular we considered binary-single encounters involving at least one compact object; this selection retained about half of all fewbody encounters in the catalog of models.

BSCO ejections were found to be closely linked to the dynamics of the cluster core, where the closest encounters among the densest stellar objects occur.
GCs lose mass, and generally expand as they evolve; accordingly, the majority of and the fastest BSCO ejecta were produced in the early stages of the models.
High-metallicity models had overall weaker ejection mechanisms (in frequency and maximum velocity), due to smaller stellar masses.
BSCO encounters occurring in realistic GCs are capable of accelerating stars to velocities in excess of 2000 \kms, which means that this source of runaways cannot be entirely ruled out by a simple velocity cut.
We also note that these velocities appear to pass the speed limit on star-only fewbody encounters set by \citet{1991AJ....101..562L}; further study is needed to confirm if this is cause by the inclusion of compact objects or another factor.

While ejected objects evolve to be largly indistinguishable from other MW stars in terms of position, they were found capable of retaining some information about the motion of their GC of origin, particularly in the case of GCs with near-circular orbits.
The overall population of ejecta was usually concentrated around the average proper motion of the GC throughout its orbit.
It is important to realize that the present-day proper motion of a GC may not reflect this average proper motion, and that in general a better kinematic picture is possible if the orbit is back-integrated.

In the galactic context, the velocity distribution of the synthetic ejecta was found to be similar to that of HVS observations at relatively low velocities; specifically, out population was skewed towards these velocities with respect to observations.
With galactic-center origin studies finding distributions skewed towards higher velocities in the same respect, it is possible that a mixture of the two could be used to more accurately model the real population of these objects.
Such a calculation must be done in light of the relative rates of the two mechanisms: our study concludes that the GC BSCO runaway rate might have been a few 10\% of the overall rate in the first few Gyr of the universe, but today is no more than 10\%.

\begin{figure}
    \script{generate_credible_regions.py}
    \begin{centering}
        \includegraphics[width=\linewidth]{figures/generate_credible_regions.pdf}
        \label{fig:generate_credible_regions}
    \end{centering}
\end{figure}

\bibliography{bib}

\end{document}
